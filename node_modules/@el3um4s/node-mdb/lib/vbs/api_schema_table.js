"use strict";
// c:\Windows\SysWOW64\cscript.exe .\api_query_all_values.vbs adodb.mdb users [JSON/CSV]
Object.defineProperty(exports, "__esModule", { value: true });
exports.api_schema_table = void 0;
const OpenConnection_1 = require("./helpers/OpenConnection");
const CloseRecordset_1 = require("./helpers/CloseRecordset");
const GenerateConnectionString_1 = require("./helpers/GenerateConnectionString");
const CloseConnection_1 = require("./helpers/CloseConnection");
const GetSchemaOneTable_1 = require("./base/GetSchemaOneTable");
exports.api_schema_table = `
${OpenConnection_1.openConnection}
${CloseRecordset_1.closeRecordset}
${GenerateConnectionString_1.generateConnectionString}
${CloseConnection_1.closeConnection}

${GetSchemaOneTable_1.getSchemaOneTable}

Dim nameDatabase
nameDatabase = WScript.Arguments.Item(0)

Dim nameTable
nameTable = WScript.Arguments.Item(1)

Dim format
format = "JSON"  'CSV - JSON

If Wscript.Arguments.Unnamed.Count = 3 then
	format = WScript.Arguments.Item(2) 'CSV - JSON
End If

Dim sConnectionString
sConnectionString = GenerateConnectionString(nameDatabase)

Set objConnection = CreateObject("ADODB.Connection")
objConnection.Open(sConnectionString)

dim schema

If UCase(format) = "CSV" then
    schema = GetSchemaTable_One_CSV(objConnection, nameTable)
Else
    schema = GetSchemaTable_One_JSON(objConnection, nameTable)
End if

Wscript.Echo schema`;
